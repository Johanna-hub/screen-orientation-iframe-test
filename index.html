<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>
      Iframe Testing
    </title>
    <script src="mobileconsole.js"></script>
    <style>
       ::backdrop { background-color: white; }
    </style>
  </head>
  <body>
    <section>
      <p>
        Screen Orientation Iframe Refactor 7

      </p>
      <button onclick=document.documentElement.requestFullscreen()>Full Screen</button>
      <button onclick="makeIFrame()">Make iframe</button>
      <button onclick="iframeTest()">Iframe Test</button>
  </body>
  <script>
    async function makeIFrame(src = "about:blank") {
      const iframe = document.createElement("iframe");
      iframe.srcdoc = `Test`;
      iframe.id = 'iframe';
      document.body.appendChild(iframe);
      await new Promise(r => {
        if (iframe.contentDocument.readyState === "complete") {
        return r(); // it's loaded
        }
        iframe.onload = r;
      });
      return iframe;
    }
   
    async function promise_test(test) {
      try {
        await test();
      } catch (err) {
      console.log(`Error is ${err}`);
      }
    }

    async function iframeTest() {
      const iframe = document.querySelector("iframe");
      await iframe.requestFullscreen()
      // const iframeOrientation = iframe.contentWindow.screen.orientation.type;
      // const iframePortrait = iframeOrientation.includes("portrait");
      // const newFrameOrientation = `${
      //   iframePortrait ? "landscape" : "portrait"
      // }-primary`;

      // const currentOrientation = screen.orientation.type;
      // const isPortrait = currentOrientation.includes("portrait");
      // const newOrientation = `${isPortrait ? "landscape" : "portrait"}-primary`;
      try {
        screen.orientation.lock("landscape-primary");
      } catch (err) {
        console.log(`Window error is ${err}`);
      }
      try {
        iframe.contentWindow.screen.orientation.lock("landscape-secondary");
      } catch (err) {
        console.log(`Iframe error is ${err}`);
      }
      // screen.orientation.unlock();
      // await document.exitFullscreen();
      // iframe.remove();
    }
  </script>
</html>


